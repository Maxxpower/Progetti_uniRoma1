<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<meta charset="ISO-8859-1"></meta>
	<title>HivesManager</title>


</h:head>
<h:body>

	<ui:composition template="template/main_template.xhtml">

		<ui:define name="content">



			<fieldset class="accordion">

				<h3>Inserimento/Upload</h3>
				<div>
					<h:form id="uploadForm" enctype="multipart/form-data">
						<h:panelGrid columns="3">
							<h:inputFile class="button" id="xmlUpload"
								value="#{hiveBean.xmlFile}" required="true"
								requiredMessage="Seleziona un file!">
								<f:validator validatorId="fileValidator" />
							</h:inputFile>
							<h:message id="xmlInErr" for="xmlUpload" styleClass="error" />
							<h:commandButton class="button" value="Carica documento"
								action="#{hiveBean.uploadRecord}">
								<f:ajax execute="@form" render="@all" />
							</h:commandButton>

						</h:panelGrid>




					</h:form>





				</div>
				<h3>Tabella Storico</h3>
				<div>
					<h:panelGroup id="storicoArnie" layout="block">
						<h:form>
							<h:dataTable id="tableArnie" value="#{hiveBean.storicoArnie}"
								var="hive" border="1" styleClass="mainTable"
								headerClass="heading" rowClasses="even2,odd2"
								columnClasses="column3,column2,column2,column2,column2">

								<h:column>
									<f:facet name="header">
										<h:commandLink actionListener="#{hiveBean.sortHiveTable}"
											style="color:white;">N.Arnia
									<f:ajax render=":storicoArnie" onevent="reloadJqueryUI" />
										</h:commandLink>
									</f:facet>

									<h:outputText id="NomeArnia" value="#{hive.name}" />
								</h:column>


								<h:column>
									<f:facet name="header">Ultimo Controllo</f:facet>
									<h:outputText id="dataControllo" value="#{hive.checked_at}"
										styleClass="#{hive.getDateColorClass(hive.checked_at)}"
										rendered="#{!hive.editable}">
										<f:convertDateTime dateStyle="full" timeZone="CET" type="date" />
									</h:outputText>
									<h:panelGroup rendered="#{hive.editable}">
										<h:outputText value="Data controllo"
											rendered="#{hive.editable}" />
										<br />
										<h:inputText id="dCon" value="#{hive.checked_at}"
											rendered="#{hive.editable}" class="date">

											<f:convertDateTime pattern="dd/MM/yy" />
											<f:validator validatorId="dateValidator" />
											<f:ajax event="change" render="dConError" />
										</h:inputText>
										<br />
										<h:message id="dConError" for="dCon" styleClass="error" />
									</h:panelGroup>
								</h:column>

								<h:column>
									<f:facet name="header">Controllo Regina</f:facet>
									<h:outputText id="controlloRegina"
										value="#{not empty hive.queen_bee_checked_at ? hive.queen_bee_checked_at : 'Controllo non registrato'}"
										styleClass="#{hive.getDateColorClass(hive.queen_bee_checked_at)}"
										rendered="#{!hive.editable}">
										<f:convertDateTime dateStyle="full" timeZone="CET" type="date" />
									</h:outputText>
									<h:panelGroup rendered="#{hive.editable}">
										<h:outputText value="Data controllo"
											rendered="#{hive.editable}" />
										<br />
										<h:inputText id="qCheck" value="#{hive.queen_bee_checked_at}"
											rendered="#{hive.editable}" class="date">

											<f:convertDateTime pattern="dd/MM/yy" />
											<f:validator validatorId="dateValidator" />
											<f:ajax event="change" render="qCheckErr" />
										</h:inputText>
										<br />
										<h:message id="qCheckErr" for="qCheck" styleClass="error" />
										<br />

										<h:outputText value="Colore ape regina"
											rendered="#{hive.editable}" />
										<br />
										<h:selectOneMenu value="#{hive.queen_bee_color}"
											rendered="#{hive.editable}" class="menuTendina">
											<f:selectItems value="#{hiveBean.queenColors}" var="col"
												itemLabel="#{col}" itemValue="#{col}" />
										</h:selectOneMenu>
										<br />

										<h:outputText value="Salute ape Regina"
											rendered="#{hive.editable}" />
										<br />
										<h:inputText id="setQhealth"
											value="#{hive.queen_bee_goodness}"
											rendered="#{hive.editable}" />

									</h:panelGroup>
									<p:tooltip id="tooltipRegina" for="controlloRegina"
										rendered="#{!hive.editable}">
										<li><b>Colore ape regina: </b> <h:outputText
												value="#{not empty hive.queen_bee_color ? hive.queen_bee_color : 'Regina non colorata!'}"
												style="background-color:#{hive.queenBeeColorClass()}" /></li>
										<li><b>Salute ape regina: </b> <h:outputText
												value="#{hive.queen_bee_goodness}" /></li>
										<li><b>Stato cellette reali: </b> <h:outputText
												value="#{not empty hive.royal_cells_status ? hive.royal_cells_status : 'Dato non registrato'}" /></li>
										<li><b>Stato covata: </b> <h:outputText
												value="#{not empty hive.brood_state ? hive.brood_state : 'Dato non registrato'}" /></li>
									</p:tooltip>
								</h:column>

								<h:column>
									<f:facet name="header">Controllo varroa</f:facet>
									<h:outputText id="controlloVarroa"
										value="#{hive.varroa_checked_at}" rendered="#{!hive.editable}"
										styleClass="#{hive.getDateColorClass(hive.varroa_checked_at)}">
										<f:convertDateTime dateStyle="full" timeZone="CET" type="date" />
									</h:outputText>
									<h:outputText value="Data controllo"
										rendered="#{hive.editable}" />

									<h:panelGroup rendered="#{hive.editable}">
										<br />
										<h:inputText id="varroaIn" value="#{hive.varroa_checked_at}"
											rendered="#{hive.editable}" class="date">

											<f:convertDateTime pattern="dd/MM/yy" />
											<f:validator validatorId="dateValidator" />
											<f:ajax event="change" render="varroaInerr" />
										</h:inputText>

										<br />
										<h:message for="varroaIn" id="varroaInerr" styleClass="error" />
										<br />

										<h:outputText value="Controllo vassoio"
											rendered="#{hive.editable}" />
										<br />
										<h:inputText id="trayCheckIn" value="#{hive.tray_checked_at}"
											rendered="#{hive.editable}" class="date">
											<f:convertDateTime pattern="dd/MM/yy" />
											<f:validator validatorId="dateValidator" />
											<f:ajax event="change" render="trayCheckErr" />
										</h:inputText>

										<br />
										<h:message for="trayCheckIn" id="trayCheckErr"
											styleClass="error" />
										<br />

										<h:outputText value="Stato Varroa" rendered="#{hive.editable}" />
										<br />
										<h:selectOneMenu value="#{hive.varroa_status}"
											rendered="#{hive.editable}" class="menuTendina">
											<f:selectItems value="#{hiveBean.varroaSatuses}" var="stato"
												itemValue="#{stato}" itemLabel="#{stato}" />
										</h:selectOneMenu>
									</h:panelGroup>
									<p:tooltip id="tooltipVarroa" for="controlloVarroa"
										rendered="#{! hive.editable}">
										<li><b>Stato varroa: </b> <h:outputText
												value="#{hive.varroa_status}"
												styleClass="#{hive.varroaStateColorClass()}" /></li>
										<li><b>Controllo vassoio: </b> <h:outputText
												value="#{hive.tray_checked_at}"
												styleClass="#{hive.getDateColorClass(hive.tray_checked_at)}">
												<f:convertDateTime dateStyle="full" timeZone="CET"
													type="date" />
											</h:outputText></li>
									</p:tooltip>
								</h:column>

								<h:column>
									<f:facet name="header">Aiuto invernale</f:facet>
									<h:outputText id="winterCheck"
										value="#{hive.candy_supplied_at}"
										styleClass="#{hive.getDateColorClass(hive.candy_supplied_at)}"
										rendered="#{!hive.editable}">
										<f:convertDateTime dateStyle="full" timeZone="CET" type="date" />
									</h:outputText>
									<h:outputText value="Data aggiunta candito"
										rendered="#{hive.editable}" />

									<h:panelGroup rendered="#{hive.editable}">
										<br />
										<h:inputText id="candyIn" value="#{hive.candy_supplied_at}"
											rendered="#{hive.editable}" class="date">

											<f:convertDateTime pattern="dd/MM/yy" />
											<f:validator validatorId="dateValidator" />
											<f:ajax event="change" render="candyErr" />
										</h:inputText>

										<br />
										<h:message for="candyIn" id="candyErr" styleClass="error" />
										<br />


										<h:outputText value="Data controllo sciroppo1:"
											rendered="#{hive.editable}" />
										<br />
										<h:inputText id="s1In" value="#{hive.syrup1_supplied_at}"
											rendered="#{hive.editable}" class="date">
											<f:convertDateTime pattern="dd/MM/yy" />
											<f:validator validatorId="dateValidator" />
											<f:ajax event="change" render="s1Err" />
										</h:inputText>

										<br />
										<h:message for="s1In" id="s1Err" styleClass="error" />
										<br />
										<h:outputText value="Data controllo sciroppo2:"
											rendered="#{hive.editable}" />
										<br />
										<h:inputText id="s2In" value="#{hive.syrup2_supplied_at}"
											rendered="#{hive.editable}" class="date">
											<f:convertDateTime pattern="dd/MM/yy" />
											<f:validator validatorId="dateValidator" />
											<f:ajax event="change" render="s2Err" />
										</h:inputText>
									</h:panelGroup>

									<br />
									<h:message for="s2In" id="s2Err" styleClass="error" />
									<br />

									<p:tooltip id="tooltipWinter" for="winterCheck"
										rendered="#{!hive.editable}">
										<li><b>Controllo sciroppo 1: </b> <h:outputText
												value="#{not empty hive.syrup1_supplied_at ? hive.syrup1_supplied_at : 'Dato non registrato'}"
												styleClass="#{hive.getDateColorClass(hive.syrup1_supplied_at)}">
												<f:convertDateTime dateStyle="full" timeZone="CET"
													type="date" />
											</h:outputText></li>
										<li><b>Controllo sciroppo 2: </b> <h:outputText
												value="#{not empty hive.syrup2_supplied_at ? hive.syrup2_supplied_at : 'Dato non registrato'}"
												styleClass="#{hive.getDateColorClass(hive.syrup2_supplied_at)}">
												<f:convertDateTime dateStyle="full" timeZone="CET"
													type="date" />
											</h:outputText></li>

									</p:tooltip>

								</h:column>

								<h:column>

									<f:facet name="header">Produzione miele</f:facet>
									<h:outputText value="#{hive.honey_production_qty}" />
								</h:column>

								<h:column>

									<f:facet name="header">Modifica</f:facet>
									<h:panelGrid columns="2">
										<h:commandButton class="button" id="editB" value="Modifica"
											action="#{hiveBean.setEditableRecord(hive)}"
											rendered="#{not hive.editable}">
											<f:ajax execute="@form" render=" :storicoArnie"
												onevent="reloadJqueryUI" />
										</h:commandButton>


										<h:commandButton class="button" id="confirm" value="Applica"
											action="#{hiveBean.editRecordInPlace(hive)}"
											rendered="#{hive.editable}">
											<f:ajax execute="@form" render=" :storicoArnie"
												onevent="reloadJqueryUI" />
										</h:commandButton>

										<h:commandButton class="button" id="cancel" value="Annulla"
											action="#{hiveBean.cancelEdit(hive)}"
											rendered="#{hive.editable}">
											<f:ajax execute="@form" render=" :storicoArnie :schedule"
												onevent="reloadJqueryUI" />
										</h:commandButton>
									</h:panelGrid>
								</h:column>
							</h:dataTable>
						</h:form>
					</h:panelGroup>

				</div>
 


			</fieldset>

		</ui:define>
	</ui:composition>
</h:body>
</html>